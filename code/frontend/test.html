<!doctype html>
<html>

<head>
    <meta charset="utf-8">

    <title>Visualizer | Word Table</title>

    <link rel="stylesheet" href="css/main.css">
    <script src="js/mongo_query.js"></script>
    <script src="js/stopwords.js"></script>
    <script src="js/word_merge.js"></script>
</head>

<body>
    <!-- first place a loading animation here -->
    <img src="img/loading.svg" alt="loading..." class="loading"/>
    <main id="out">
        <!--the actual content goes here -->
        <script>
                function map() {
                var words = this.text.replace(/[^A-Za-zÄäÖöÜüß ]/g, " ").split(" ");
                for (var i = 0; i < words.length; i++) {
                    var word = words[i];
                    if(word) {
                      emit(words[i], 1);
                    }
                }
            }

            function render(obj) {
                obj = obj.filter(word => stopwords.indexOf(word["_id"].toLowerCase()) < 0).sort((a,b) => b["value"] - a["value"]);
                // word_merge(obj);

                var table = "<h1>Most often used words:</h1>" +
                "<table style='margin: auto;'>";
                table += "<tr><th>word</th><th>count</th></tr>";
                obj.forEach(elm => {
                    table += "<tr><td>" + elm["_id"] + "</td><td>" + elm["value"] + "</td></tr>";
                });
                table += "</table>";

                document.getElementById("out").innerHTML = table;

                data = obj;
            }

            var data = [];
            // mongo_query(map, count, render, "http://metamax.tk");
            data = [
                {
                    "_id" : "Jahr",
                    "value" : 42,
                },
                {
                    "_id" : "Jahre",
                    "value" : 42,
                },                {
                    "_id" : "Jahrn",
                    "value" : 42,
                },
                {
                    "_id" : "Mensch",
                    "value" : 42,
                },
                {
                    "_id" : "Menschen",
                    "value" : 42,
                },
                {
                    "_id" : "Random",
                    "value" : 42,
                }
            ];
            render(data);
        </script>
    </main>
</body>

</html>
