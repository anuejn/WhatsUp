<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Was ist los?</title>

    <script src="js/mongo_query.js"></script>
    <script>

        // fill the form
        function map() {
            emit(this.meta.source, 0)
        }

        function render(res) {
            var newspapers = res.map(e => e["_id"]);

            var checkboxHtml = newspapers.map(e => '<label for="' + e + '">' + e + '</label><input type="checkbox" id="' + e + '"><br>');
            document.getElementById("newspapers").innerHTML = checkboxHtml.reduce((a, b) => a + b);

            Array.from(document.getElementsByTagName("input")).forEach(el => el.onchange = update)
        }

        mongo_query(map, count, render);

        window.onload = () => {
            var form = document.getElementsByTagName("form")[0];
            console.log(form);

            form.addEventListener("submit", event => {
                event.preventDefault();

                var from = document.getElementById("from").value;
                var to = document.getElementById("to").value;

                if(!(from && to)) {
                    alert("enter valid dates!");
                    return;
                }

                from = + new Date(from);
                to = + new Date(to);

                var query = {
                    
                }
            });
        };
    </script>
</head>
<body>
    <form>
        <p>
            <label for="from">from:</label><input type="datetime-local" id="from"></br>
            <label for="to">to:</label><input type="datetime-local" id="to">
        </p>
        <p id="newspapers">
            <!-- this is autogenerated -->
        </p>
        <input type="submit">
    </form>
</body>
</html>
